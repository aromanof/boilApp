<div class="header">
  <div class="container-fluid d-flex align-content-center">
    <div class="logo d-flex align-content-center">
      <img class="logo__image cursor-pointer" src="./assets/svg/v-ticket__logo_white.svg" alt="v-ticket logo"
           [routerLink]="(headerDataFacade().navItems && headerDataFacade().navItems[0] && headerDataFacade().navItems[0].url) ? headerDataFacade().navItems[0].url : ''">
    </div>
    <div class="nav d-flex align-content-center">
      <ng-container *ngFor="let navItem of headerDataFacade().navItems">
        <a *ngIf="showMenuItem(navItem.url)"
           [tourAnchor]="getTourAnchor(navItem.url)"
           class="nav__item d-flex flex-column justify-content-center"
           [routerLink]="navItem.url"
           routerLinkActive="nav__item_active">
          <span>{{navItem.text}}</span>
        </a>
      </ng-container>
    </div>
    <div class="promoter-picker__wrap ml-auto" *ngIf="isAdmin && isPromoterOpened">
      <input
              #promoter
              type="text"
              [matAutocomplete]="autocomplete"
              class="promoter-picker__autocomplete"
              [class.promoter_p]="selectedPromoter"
              placeholder="Выберите организатора"
              i18n-placeholder="Шапка для десктопа| Плейсхолдер поля для выбора организатора"
              (input)="promoterInput$.next($event)"
              [value]="selectedPromoter"
      />
      <span (click)="clearPromoterField(promoter)"
            *ngIf="selectedPromoter"
            class="promoter-clear"
      ><mat-icon>clear</mat-icon></span>

      <mat-autocomplete #autocomplete
                        (optionSelected)="changePromoter($event.option.value); promoter.blur()"
                        [displayWith]="displayPromotersFn"
      >
        <mat-option *ngFor="let promoter of (promotersList$ | async)"
                    [value]="promoter"
        >
          {{ promoter.title }}
        </mat-option>
      </mat-autocomplete>
    </div>


    <div class="actions d-flex" [class.ml-auto]="!isPromoterOpened || !isAdmin">
      <div *ngIf="isCashierOpened" class="header__check-in d-flex">
        <button *ngIf="!eventListDataService.cashierCheckedIn.getValue(); else checkOut"
                mat-icon-button
                tourAnchor="header_cashierCheckIn"
                [disabled]="disableShiftButton"
                (click)="openCashierShift()"
                matTooltip="Открыть смену"
                i18n-matTooltip="Шапка для десктопа| Хинт поля для открытия смены"
                class="header__check-in__button d-flex tc-white-700">
          <mat-icon>assignment_ind</mat-icon>
        </button>

        <ng-template #checkOut>
          <button class="header__check-in__button d-flex tc-white-700"
                  [disabled]="disableShiftButton"
                  mat-icon-button (click)="closeCashierShift()"
                  matTooltip="Закрыть смену"
                  i18n-matTooltip="Шапка для десктопа| Хинт поля для закрытия смены"
          >
            <mat-icon>exit_to_app</mat-icon>
          </button>
        </ng-template>
      </div>
      <div class="username d-flex flex-column justify-content-center">{{headerDataFacade().interfaceTitle}}</div>
      <div class="d-flex dropdown-activators" (mouseleave)="deactivateAllActions()">
        <div tourAnchor="header_interfaces" class="interfaces d-flex flex-column justify-content-center"
             (mouseenter)="mouseEntersActivator('interfaces')">
          <span class="icon interfaces__icon"></span>
        </div>
        <div tourAnchor="header_notifications" class="notifications d-flex flex-column justify-content-center"
             (mouseenter)="mouseEntersActivator('notifications')">
          <img class="icon notifications__icon" [src]="notificationsIconSrc()" alt="">
        </div>
        <div tourAnchor="header_profile" class="profile d-flex flex-column justify-content-center"
             (mouseenter)="mouseEntersActivator('profile')">
          <img [src]="getProfileAvatarPath(30)" class="profile__photo" alt="user photo">
        </div>
        <div
                class="actions-dropdown z-index-1100"
                [class.active-slide_interfaces]="interfacesIsActive"
                [class.active-slide_notifications]="notificationsIsActive"
                [class.active-slide_profile]="profileIsActive"
                *ngIf="navigationIsActive || interfacesIsActive || notificationsIsActive || profileIsActive"
                [@fadeInOut]
        >
          <div class="actions-dropdown__caret"></div>
          <div class="actions-dropdown__content">
            <div class="slides d-flex">
              <!-- interfaces -->
              <div class="slide slide_interfaces flex-column">
                <div class="slide__header d-flex justify-content-between align-items-baseline">
                  <span i18n="Поп-ап выбора приложений|Заголовок в поп-апе выбора приложения">Приложения</span>
                </div>
                <div class="divider"></div>
                <div class="slide__body d-flex flex-wrap pb-2 pt-2">
                  <div
                          *ngFor="let userInterface of headerDataFacade().userInterfaces"
                          [routerLink]="userInterface.url"
                          class="interface-card d-flex flex-column justify-content-center align-items-center cursor-pointer">
                    <img [src]="userInterface.image" alt="interface-card__image">
                    <span class="interface-card__title text-truncate text-center">{{userInterface.title}}</span>
                  </div>
                </div>
              </div>
              <!-- // interfaces -->
              <!-- notifications -->
              <div class="slide slide_notifications flex-column"
                   [class.slide_notifications-empty]="headerDataFacade().notifications.length === 0">
                <div class="slide__header d-flex justify-content-between align-items-baseline">
                  <span i18n="Шапка для десктопа| Название блока с уведомлениями">Уведомления</span>
                  <span *ngIf="!(headerDataFacade().notifications.length === 0)"
                        class="secondary-text cursor-pointer hover-color-primary transition"
                        (click)="hs.clearNotifications()"
                        i18n="Шапка для десктопа| Текст кнопки для скрытия всех уведомлений"
                  >Скрыть все</span>
                </div>
                <div class="divider"></div>
                <div class="slide__body slide__body_scrollable">
                  <div *ngFor="let notification of headerDataFacade().notifications"
                       class="notification-card d-flex align-items-center cursor-pointer">
                    <div class="notification-card__status"
                         [class.notification-card__status_new]="notification.isNew"></div>
                    <img class="notification-card__image d-flex" [src]="notification.image" alt="">
                    <div class="notification-card__text d-flex flex-column">
                      <div class="notification-card__title text-truncate">{{notification.title}}
                      </div>
                      <span class="notification-card__description secondary-text text-truncate">{{notification.description}}</span>
                    </div>
                  </div>

                  <div class="notification-card notification-card_empty-message flex-column align-items-center justify-content-center">
                    <img src="./assets/svg/icon_notifications-empty.svg" alt="no notifications">
                    <span class="secondary-text mt-2"
                          i18n="Шапка для десктопа| Текст, выводящийся если не было найдено ни одного уведомления">Уведомлений нет</span>
                  </div>
                </div>
                <div class="slide__footer text-center secondary-text cursor-pointer"
                     i18n="Шапка для десктопа| Текст для вывода всех уведомлений"
                >
                  Все уведомления
                </div>
              </div>
              <!-- // notifications -->
              <div class="slide slide_profile d-flex flex-column">
                <div class="slide__body d-flex">
                  <div class="profile__photo cursor-pointer position-relative"
                       [style.background-image]="'url(' +
                    getProfileAvatarPath(100) + ')'">
                    <div class="profile__edit-photo position-absolute w-100 h-100 d-flex justify-content-center align-items-center">
                      <img src="./assets/svg/icon_photo.svg" alt="edit profile photo">
                    </div>
                  </div>
                  <div class="profile__text d-flex flex-column justify-content-center">
                    <span class="profile__name">{{headerDataFacade().profile.name}}</span>
                    <span class="profile__email text-color-secondary text-ellipsis">{{headerDataFacade().profile.email}}</span>
                  </div>
                </div>
                <div class="slide__footer d-flex">
                  <!--<span routerLink="'promoter/settings'" class="text-color-secondary text-uppercase hover-color-primary transition cursor-pointer">Настройки</span>-->
                  <div class="language-switcher" *ngIf="activeBuildMode === buildModeEnum.VTicket">
                    <button mat-button
                            class="language-btn"
                            [class.primary]="language === activeLanguage"
                            *ngFor="let language of languages"
                            (click)="onChangeLanguage(language)">
                      {{ language }}
                    </button>
                  </div>
                  <span (click)="onLogOut()"
                        class="text-color-secondary text-uppercase hover-color-primary transition cursor-pointer ml-auto"
                        i18n="Шапка для десктопа| Текст кнопки для выхода из аккаунта"
                  >Выйти
                                    </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
